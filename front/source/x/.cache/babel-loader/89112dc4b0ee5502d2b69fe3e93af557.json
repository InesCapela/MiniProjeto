{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/app/src/components/Places/Places.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { Redirect } from 'react-router';\nimport Place from './Place';\nimport * as actions from '../../store/actions/index';\nimport * as api from '../../store/actions/api';\nimport socketIOClient from \"socket.io-client\";\nimport HomeIcon from '@material-ui/icons/Home';\nimport List from '@material-ui/core/List';\nimport { CircularProgress } from '@material-ui/core';\nimport { useStyles } from '../Styles/Styles';\nimport InfoPlace from './InfoPlace';\n\nconst Places = props => {\n  _s();\n\n  var socket;\n\n  if (socket == null) {\n    socket = socketIOClient(api.URL_SOCKETIO, {\n      withCredentials: true,\n      transportOptions: {}\n    });\n  }\n\n  const token = props.token;\n  socket.on(\"connect\", () => {\n    socket.emit(\"set-token\", token);\n    console.log(\"TOKEN: \");\n    console.log(token);\n  });\n  const [selectedPlace, setSelectedPlace] = useState(null); // styles\n\n  const classes = useStyles(); //dependecy\n\n  const {\n    onGetAllPlaces,\n    onGetUserPlaces\n  } = props;\n  useEffect(() => {\n    if (props.token !== null) {\n      if (props.isAdmin) {\n        onGetAllPlaces(props.token);\n      } else {\n        onGetUserPlaces(props.token);\n      }\n    }\n  }, [onGetAllPlaces, onGetUserPlaces, props.token, props.isAdmin]);\n\n  let places = /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 18\n  }, this);\n\n  const selectedPlaceHandler = (event, place, socket) => {\n    event.preventDefault();\n    setSelectedPlace(place, socket);\n  };\n\n  const updatePlaceHandler = (event, place) => {\n    event.preventDefault(); // update place\n\n    props.onUpdatePlace(place, props.token);\n  };\n\n  const deletePlaceHandler = (event, id) => {\n    event.preventDefault(); // delete place\n\n    props.onDeletePlace(id, props.token);\n    setSelectedPlace(null);\n  };\n\n  if (!props.loading) {\n    places = props.places.map(place => {\n      return /*#__PURE__*/_jsxDEV(Place, {\n        id: place.ID,\n        name: place.name,\n        lat: place.latitude,\n        lng: place.longitude,\n        persons: place.people,\n        selectPlace: selectedPlaceHandler\n      }, place.ID, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 20\n      }, this);\n    });\n  }\n\n  if (places.length === 0) {\n    places = /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Not found!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 19\n    }, this);\n  }\n\n  let isAuth = !props.token ? /*#__PURE__*/_jsxDEV(Redirect, {\n    to: \"/\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 33\n  }, this) : null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [isAuth, /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.places,\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: [\"Places \", /*#__PURE__*/_jsxDEV(HomeIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 28\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          width: '100%'\n        },\n        children: [/*#__PURE__*/_jsxDEV(List, {\n          children: places\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 21\n        }, this), selectedPlace && places.length !== 0 ? /*#__PURE__*/_jsxDEV(InfoPlace, {\n          isAdmin: props.isAdmin,\n          place: selectedPlace,\n          socket: socket,\n          updatePlace: updatePlaceHandler,\n          deletePlace: deletePlaceHandler\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 61\n        }, this) : null]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 91,\n    columnNumber: 9\n  }, this);\n}; // get state from reducer\n\n\n_s(Places, \"ket6oXA4E1WZVkEr9sun8EW2aQQ=\", false, function () {\n  return [useStyles];\n});\n\n_c = Places;\n\nconst mapStateToProps = state => {\n  return {\n    token: state.auth.token,\n    isAdmin: state.auth.isAdmin,\n    places: state.places.places,\n    loading: state.loadingError.loading,\n    error: state.loadingError.error\n  };\n}; // actions to reducer (dispatch)\n\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    onGetAllPlaces: token => dispatch(actions.fetchAllPlaces(token)),\n    onGetUserPlaces: token => dispatch(actions.fetchUserPlaces(token)),\n    onUpdatePlace: (place, token) => dispatch(actions.editPlace(place, token)),\n    onDeletePlace: (id, token) => dispatch(actions.deletePlace(id, token))\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Places);\n\nvar _c;\n\n$RefreshReg$(_c, \"Places\");","map":{"version":3,"sources":["/app/src/components/Places/Places.js"],"names":["React","useEffect","useState","connect","Redirect","Place","actions","api","socketIOClient","HomeIcon","List","CircularProgress","useStyles","InfoPlace","Places","props","socket","URL_SOCKETIO","withCredentials","transportOptions","token","on","emit","console","log","selectedPlace","setSelectedPlace","classes","onGetAllPlaces","onGetUserPlaces","isAdmin","places","selectedPlaceHandler","event","place","preventDefault","updatePlaceHandler","onUpdatePlace","deletePlaceHandler","id","onDeletePlace","loading","map","ID","name","latitude","longitude","people","length","isAuth","display","width","mapStateToProps","state","auth","loadingError","error","mapDispatchToProps","dispatch","fetchAllPlaces","fetchUserPlaces","editPlace","deletePlace"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { Redirect } from 'react-router';\n\nimport Place from './Place';\nimport * as actions from '../../store/actions/index';\nimport * as api from '../../store/actions/api';\nimport socketIOClient from \"socket.io-client\";\nimport HomeIcon from '@material-ui/icons/Home';\nimport List from '@material-ui/core/List';\nimport { CircularProgress } from '@material-ui/core';\nimport { useStyles } from '../Styles/Styles';\nimport InfoPlace from './InfoPlace';\n\nconst Places = props => {\n\n    var socket;\n    if(socket == null) {\n        socket = socketIOClient(api.URL_SOCKETIO, {\n            withCredentials: true, transportOptions: {}\n        });\n    }\n\n    const token = props.token\n    socket.on(\"connect\", () => {\n        socket.emit(\"set-token\", token)\n        console.log(\"TOKEN: \")\n        console.log(token)\n    })\n\n    const [selectedPlace, setSelectedPlace] = useState(null);\n\n    // styles\n    const classes = useStyles();\n\n    //dependecy\n    const { onGetAllPlaces, onGetUserPlaces } = props;\n\n    useEffect(() => {\n        if (props.token !== null) {\n            if (props.isAdmin) {\n                onGetAllPlaces(props.token);\n            } else {\n                onGetUserPlaces(props.token)\n            }\n        }\n    }, [onGetAllPlaces, onGetUserPlaces, props.token, props.isAdmin])\n\n\n    let places = <CircularProgress />\n\n    const selectedPlaceHandler = (event, place, socket) => {\n        event.preventDefault();\n        setSelectedPlace(place, socket);\n    }\n\n    const updatePlaceHandler = (event, place) => {\n        event.preventDefault();\n        // update place\n        props.onUpdatePlace(place, props.token);\n    }\n\n    const deletePlaceHandler = (event, id) => {\n        event.preventDefault();\n        // delete place\n        props.onDeletePlace(id, props.token);\n        setSelectedPlace(null);\n    }\n\n    if (!props.loading) {\n        places = props.places.map(place => {\n            return <Place\n                key={place.ID}\n                id={place.ID}\n                name={place.name}\n                lat={place.latitude}\n                lng={place.longitude}\n                persons={place.people}\n                selectPlace={selectedPlaceHandler}\n            />\n        });\n    }\n\n    if (places.length === 0) {\n        places = (<h3>Not found!</h3>);\n    }\n\n    let isAuth = !props.token ? <Redirect to='/' /> : null;\n\n    return (\n        <div>\n            {isAuth}\n            <div className={classes.places}>\n                <h1>Places <HomeIcon /></h1>\n                <div style={{ display: 'flex', width: '100%' }}>\n                    <List>\n                        {places}\n                    </List>\n\n                    {selectedPlace && places.length !== 0 ? <InfoPlace\n                        isAdmin={props.isAdmin}\n                        place={selectedPlace}\n                        socket={socket}\n                        updatePlace={updatePlaceHandler}\n                        deletePlace={deletePlaceHandler}\n                    /> : null}\n                </div>\n            </div>\n        </div>\n    );\n\n}\n\n// get state from reducer\nconst mapStateToProps = (state) => {\n    return {\n        token: state.auth.token,\n        isAdmin: state.auth.isAdmin,\n        places: state.places.places,\n        loading: state.loadingError.loading,\n        error: state.loadingError.error,\n    };\n}\n\n// actions to reducer (dispatch)\nconst mapDispatchToProps = (dispatch) => {\n    return {\n        onGetAllPlaces: (token) => dispatch(actions.fetchAllPlaces(token)),\n        onGetUserPlaces: (token) => dispatch(actions.fetchUserPlaces(token)),\n        onUpdatePlace: (place, token) => dispatch(actions.editPlace(place, token)),\n        onDeletePlace: (id, token) => dispatch(actions.deletePlace(id, token)),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Places);"]},"metadata":{},"sourceType":"module"}