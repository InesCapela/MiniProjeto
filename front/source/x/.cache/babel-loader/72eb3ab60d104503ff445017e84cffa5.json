{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/app/src/components/Places/Places.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { Redirect } from 'react-router';\nimport Place from './Place';\nimport * as actions from '../../store/actions/index';\nimport * as api from '../../store/actions/api';\nimport socketIOClient from \"socket.io-client\";\nimport HomeIcon from '@material-ui/icons/Home';\nimport List from '@material-ui/core/List';\nimport { CircularProgress } from '@material-ui/core';\nimport { useStyles } from '../Styles/Styles';\nimport InfoPlace from './InfoPlace';\n\nconst Places = props => {\n  _s();\n\n  const socket = props.socket;\n  socket.on(\"update-place\", data => {\n    console.log(\"NEW UPDATE: \");\n    console.log(data);\n  });\n  const [selectedPlace, setSelectedPlace] = useState(null); // styles\n\n  const classes = useStyles(); //dependecy\n\n  const {\n    onGetAllPlaces,\n    onGetUserPlaces\n  } = props;\n  useEffect(() => {\n    if (props.token !== null) {\n      if (props.isAdmin) {\n        onGetAllPlaces(props.token);\n      } else {\n        onGetUserPlaces(props.token);\n      }\n    }\n  }, [onGetAllPlaces, onGetUserPlaces, props.token, props.isAdmin]);\n\n  let places = /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 43,\n    columnNumber: 18\n  }, this);\n\n  const selectedPlaceHandler = (event, place) => {\n    event.preventDefault();\n    socket.emit(\"change-place\", place.name);\n    setSelectedPlace(place, socket);\n  }; // update place\n\n\n  const updatePlaceHandler = (event, place) => {\n    event.preventDefault();\n    props.onUpdatePlace(place, props.token);\n  }; // delete place\n\n\n  const deletePlaceHandler = (event, id) => {\n    event.preventDefault();\n    props.onDeletePlace(id, props.token);\n    setSelectedPlace(null);\n  };\n\n  const addPersonHandler = event => {\n    event.preventDefault();\n    socket.emit(\"add-people\", \"\");\n  };\n\n  const subPersonHandler = event => {\n    event.preventDefault();\n    socket.emit(\"sub-people\", \"\");\n  };\n\n  if (!props.loading) {\n    places = props.places.map(place => {\n      return /*#__PURE__*/_jsxDEV(Place, {\n        id: place.ID,\n        name: place.name,\n        lat: place.latitude,\n        lng: place.longitude,\n        persons: place.people,\n        selectPlace: selectedPlaceHandler\n      }, place.ID, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 20\n      }, this);\n    });\n  }\n\n  if (places.length === 0) {\n    places = /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Not found!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 19\n    }, this);\n  }\n\n  let isAuth = !props.token ? /*#__PURE__*/_jsxDEV(Redirect, {\n    to: \"/\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 92,\n    columnNumber: 33\n  }, this) : null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [isAuth, /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.places,\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: [\"Places \", /*#__PURE__*/_jsxDEV(HomeIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 28\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          width: '100%'\n        },\n        children: [/*#__PURE__*/_jsxDEV(List, {\n          children: places\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 21\n        }, this), selectedPlace && places.length !== 0 ? /*#__PURE__*/_jsxDEV(InfoPlace, {\n          isAdmin: props.isAdmin,\n          place: selectedPlace,\n          socket: socket,\n          updatePlace: updatePlaceHandler,\n          deletePlace: deletePlaceHandler,\n          addPersonHandler: addPersonHandler,\n          subPersonHandler: subPersonHandler\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 61\n        }, this) : null]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 9\n  }, this);\n}; // get state from reducer\n\n\n_s(Places, \"ket6oXA4E1WZVkEr9sun8EW2aQQ=\", false, function () {\n  return [useStyles];\n});\n\n_c = Places;\n\nconst mapStateToProps = state => {\n  return {\n    token: state.auth.token,\n    isAdmin: state.auth.isAdmin,\n    places: state.places.places,\n    loading: state.loadingError.loading,\n    error: state.loadingError.error\n  };\n}; // actions to reducer (dispatch)\n\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    onGetAllPlaces: token => dispatch(actions.fetchAllPlaces(token)),\n    onGetUserPlaces: token => dispatch(actions.fetchUserPlaces(token)),\n    onUpdatePlace: (place, token) => dispatch(actions.editPlace(place, token)),\n    onDeletePlace: (id, token) => dispatch(actions.deletePlace(id, token))\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Places);\n\nvar _c;\n\n$RefreshReg$(_c, \"Places\");","map":{"version":3,"sources":["/app/src/components/Places/Places.js"],"names":["React","useEffect","useState","connect","Redirect","Place","actions","api","socketIOClient","HomeIcon","List","CircularProgress","useStyles","InfoPlace","Places","props","socket","on","data","console","log","selectedPlace","setSelectedPlace","classes","onGetAllPlaces","onGetUserPlaces","token","isAdmin","places","selectedPlaceHandler","event","place","preventDefault","emit","name","updatePlaceHandler","onUpdatePlace","deletePlaceHandler","id","onDeletePlace","addPersonHandler","subPersonHandler","loading","map","ID","latitude","longitude","people","length","isAuth","display","width","mapStateToProps","state","auth","loadingError","error","mapDispatchToProps","dispatch","fetchAllPlaces","fetchUserPlaces","editPlace","deletePlace"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { Redirect } from 'react-router';\n\nimport Place from './Place';\nimport * as actions from '../../store/actions/index';\nimport * as api from '../../store/actions/api';\nimport socketIOClient from \"socket.io-client\";\nimport HomeIcon from '@material-ui/icons/Home';\nimport List from '@material-ui/core/List';\nimport { CircularProgress } from '@material-ui/core';\nimport { useStyles } from '../Styles/Styles';\nimport InfoPlace from './InfoPlace';\n\nconst Places = props => {\n\n    const socket = props.socket;\n    socket.on(\"update-place\", (data) => {\n        console.log(\"NEW UPDATE: \");\n        console.log(data);\n\n    });\n\n    const [selectedPlace, setSelectedPlace] = useState(null);\n\n    // styles\n    const classes = useStyles();\n\n    //dependecy\n    const { onGetAllPlaces, onGetUserPlaces } = props;\n\n    useEffect(() => {\n        if (props.token !== null) {\n            if (props.isAdmin) {\n                onGetAllPlaces(props.token);\n            } else {\n                onGetUserPlaces(props.token)\n            }\n        }\n    }, [onGetAllPlaces, onGetUserPlaces, props.token, props.isAdmin])\n\n\n    let places = <CircularProgress />\n\n    const selectedPlaceHandler = (event, place) => {\n        event.preventDefault();\n        socket.emit(\"change-place\", place.name);\n        setSelectedPlace(place, socket);\n    }\n\n    // update place\n    const updatePlaceHandler = (event, place) => {\n        event.preventDefault();\n        props.onUpdatePlace(place, props.token);\n    }\n\n    // delete place\n    const deletePlaceHandler = (event, id) => {\n        event.preventDefault();\n        props.onDeletePlace(id, props.token);\n        setSelectedPlace(null);\n    }\n\n    const addPersonHandler = (event) => {\n        event.preventDefault();\n        socket.emit(\"add-people\", \"\")\n    }\n\n    const subPersonHandler = (event) => {\n        event.preventDefault();\n        socket.emit(\"sub-people\", \"\")\n    }\n\n    if (!props.loading) {\n        places = props.places.map(place => {\n            return <Place\n                key={place.ID}\n                id={place.ID}\n                name={place.name}\n                lat={place.latitude}\n                lng={place.longitude}\n                persons={place.people}\n                selectPlace={selectedPlaceHandler}\n            />\n        });\n    }\n\n    if (places.length === 0) {\n        places = (<h3>Not found!</h3>);\n    }\n\n    let isAuth = !props.token ? <Redirect to='/' /> : null;\n\n    return (\n        <div>\n            {isAuth}\n            <div className={classes.places}>\n                <h1>Places <HomeIcon /></h1>\n                <div style={{ display: 'flex', width: '100%' }}>\n                    <List>\n                        {places}\n                    </List>\n\n                    {selectedPlace && places.length !== 0 ? <InfoPlace\n                        isAdmin={props.isAdmin}\n                        place={selectedPlace}\n                        socket={socket}\n                        updatePlace={updatePlaceHandler}\n                        deletePlace={deletePlaceHandler}\n                        addPersonHandler={addPersonHandler}\n                        subPersonHandler={subPersonHandler} /> : null}\n                </div>\n            </div>\n        </div>\n    );\n\n}\n\n// get state from reducer\nconst mapStateToProps = (state) => {\n    return {\n        token: state.auth.token,\n        isAdmin: state.auth.isAdmin,\n        places: state.places.places,\n        loading: state.loadingError.loading,\n        error: state.loadingError.error,\n    };\n}\n\n// actions to reducer (dispatch)\nconst mapDispatchToProps = (dispatch) => {\n    return {\n        onGetAllPlaces: (token) => dispatch(actions.fetchAllPlaces(token)),\n        onGetUserPlaces: (token) => dispatch(actions.fetchUserPlaces(token)),\n        onUpdatePlace: (place, token) => dispatch(actions.editPlace(place, token)),\n        onDeletePlace: (id, token) => dispatch(actions.deletePlace(id, token)),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Places);"]},"metadata":{},"sourceType":"module"}